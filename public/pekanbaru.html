<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Base Pekanbaru üöÄ</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #6a11cb;
      --secondary: #ff5e62;
      --accent: #36d1dc;
      --light: #ffffff;
      --dark: #2c3e50;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
      font-family: 'Poppins', sans-serif;
      min-height: 100vh; display: flex; align-items: center; justify-content: center;
      padding: 20px; position: relative; overflow-x: hidden;
    }
    .bubble { position: absolute; border-radius: 50%; background: rgba(255,255,255,0.3);
      animation: float 8s infinite ease-in-out; z-index: -1; }
    @keyframes float { 0%,100% {transform:translateY(0) rotate(0);} 50% {transform:translateY(-20px) rotate(10deg);} }
    .container {
      width:100%; max-width:600px; background:rgba(255,255,255,0.9); backdrop-filter:blur(10px);
      border-radius:20px; box-shadow:0 15px 35px rgba(0,0,0,0.1); padding:30px; text-align:center;
    }
    h1 { font-weight:800; font-size:2.5rem; margin-bottom:20px; color:var(--primary); }
    #tweetForm { display:flex; flex-direction:column; gap:20px; margin-bottom:25px; }
    textarea {
      width:100%; min-height:150px; padding:15px; border-radius:15px; border:2px solid #e2e8f0;
      font-family:'Poppins',sans-serif; font-size:1rem; resize:vertical; transition:all .3s;
    }
    textarea:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 .25rem rgba(106,17,203,.25);}
    .file-input-container { position:relative; display:flex; flex-direction:column; align-items:center; }
    .file-input-container label {
      padding:15px 25px; background:linear-gradient(135deg,var(--primary),var(--accent));
      color:white; border-radius:50px; font-weight:600; cursor:pointer; transition:.3s;
      box-shadow:0 4px 15px rgba(106,17,203,.3);
    }
    .file-input-container input[type="file"] { position:absolute; opacity:0; z-index:-1; }
    .file-name { margin-top:10px; font-size:.9rem; color:#666; }
    button {
      padding:15px 25px; background:linear-gradient(135deg,var(--secondary),#ff9966);
      color:white; border:none; border-radius:50px; font-size:1.1rem; font-weight:600;
      cursor:pointer; transition:.3s; box-shadow:0 4px 15px rgba(255,94,98,.3);
    }
    #preview { margin-top:20px; border-radius:15px; border:2px dashed #ccc; padding:20px; }
    .preview-image { max-width:100%; max-height:300px; border-radius:10px; margin-top:15px; display:none; }
    .preview-default-text { color:#888; font-size:1rem; }
    #response { margin-top:20px; padding:15px; border-radius:10px; font-weight:500; }
    .footer { margin-top:30px; font-size:.9rem; color:#777; }
  </style>
</head>
<body>
  <!-- Animated background -->
  <div class="bubble" style="width:80px;height:80px;top:10%;left:5%;"></div>
  <div class="bubble" style="width:50px;height:50px;top:20%;right:5%;"></div>
  <div class="bubble" style="width:70px;height:70px;bottom:15%;left:8%;"></div>
  <div class="bubble" style="width:60px;height:60px;bottom:25%;right:10%;"></div>

  <div class="container">
    <h1><i class="fas fa-rocket"></i>Menfess ke Twitter</h1>
    <form id="tweetForm" enctype="multipart/form-data">
      <textarea name="text" placeholder="Tulis pesan menarikmu..." required></textarea>
      <div class="file-input-container">
        <label for="imageInput"><i class="fas fa-image"></i> Pilih Gambar</label>
        <input type="file" id="imageInput" name="image" accept="image/*">
        <div class="file-name" id="fileName">Belum ada gambar dipilih</div>
      </div>
      <button type="submit"><i class="fas fa-paper-plane"></i> Kirim Menfess</button>
    </form>

    <div id="preview">
      <p class="preview-default-text">Pratinjau gambar muncul di sini</p>
      <img class="preview-image" id="previewImage">
    </div>

    <p id="response"></p>

    <div class="footer">
      <p>¬© 2025 Base Pekanbaru | Menfess Sumatra</p>
    </div>
  </div>

  <script>
    const imageInput = document.getElementById('imageInput');
    const previewImage = document.getElementById('previewImage');
    const fileName = document.getElementById('fileName');
    const tweetForm = document.getElementById('tweetForm');
    const response = document.getElementById('response');

    // Preview gambar
    imageInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        fileName.textContent = file.name;
        const reader = new FileReader();
        reader.onload = e => {
          previewImage.src = e.target.result;
          previewImage.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        fileName.textContent = 'Belum ada gambar dipilih';
        previewImage.style.display = 'none';
      }
    });

    // Form submission
const tweetForm = document.getElementById('tweetForm');
const response = document.getElementById('response');

tweetForm.addEventListener('submit', async function(e) {
  e.preventDefault();
  
  response.textContent = 'Mengirim menfess...';
  response.style.background = 'rgba(255, 193, 7, 0.2)';

  const formData = new FormData(tweetForm);

  try {
    const res = await fetch("/api/tweet", {
      method: "POST",
      body: formData
    });
    const data = await res.json();

    if (res.ok) {
      response.textContent = "‚úÖ Menfess berhasil dikirim!";
      response.style.background = 'rgba(40, 167, 69, 0.2)';
    } else {
      response.textContent = "‚ùå Gagal: " + (data.error || "Terjadi kesalahan");
      response.style.background = 'rgba(220, 53, 69, 0.2)';
    }
  } catch (err) {
    response.textContent = "‚ùå Error koneksi ke server.";
    response.style.background = 'rgba(220, 53, 69, 0.2)';
  }

  // Reset form
  tweetForm.reset();
  fileName.textContent = 'Belum ada gambar dipilih';
  previewImage.style.display = 'none';
});
  </script>
</body>
  </html>
